Brammm\CommonBundle
===================

[![Build Status](https://travis-ci.org/Brammm/CommonBundle.png?branch=master)](https://travis-ci.org/Brammm/CommonBundle)

A strongly opinionated bundle that provides some common functionality for your Symfony2 bundles.

## Opionions

- View files go in `app/`, not `src/`. To be exact, they go in `app/views/Bundle/Controller/method.html.twig`.
- Controllers are defined as services. Extend `Brammm\CommonBundle\Controller\Controller` for a good base.
- Every entity has a repository. Repositories should be defined as services so they can be injected.
- Every entity has a manager service. Managers keep the heavy lifting out of the controller.
- Controller actions don't return responses, only data. The response is generated by a view listener.
- Controller actions don't persist or flush. This happens in the managers.
 
## Install

Via Composer (the bundle isn't added to Packagist just yet, so you have to add the repository manually):

```json
{
    "repositories": [
        {
            "url": "https://github.com/Brammm/CommonBundle.git",
            "type": "git"
        }
    ],
    "require": {
        "brammm/common-bundle": "dev-master"
    }
}
```

## Usage

### Controllers as services

Define your controllers as services. They can extend the base controller for some basic functionality. 

```xml
<service id="acme_demo.controller.home"
         parent="brammm_common.controller.base"
         class="Acme\DemoBundle\Controller\HomeController">
    <argument type="service" id="some.service" />
</service>
```

**Note:** The base controller does not know about the `Container`. No magic `$this->get()`. Inject the services you really need.

### Repositories and managers

By providing each entity with a repository and a manager, you can separate any logic from your controllers and make everything more manageable.

Repositories are responsible for querying the database, managers are responsible for manipulating and writing to the database.

#### Repositories

You can declare a repository as a service by using the EntityManager as a factory.

```xml
<service id="acme_demo.repository.blog"
         class="Acme\DemoBundle\Repository\BlogRepository"
         factory-service="doctrine.orm.entity_manager"
         factory-method="getRepository">
    <argument>AcmeDemoBundle:Blog</argument>
</service>
```

#### Managers

Managers can extend the base Manager service. This will provide you with the EntityManager in your own managers. 

```xml
<service id="acme_demo.manager.blog"
         parent="brammm_common.manager"
         class="Acme\DemoBundle\Manager\BlogManager">
</service>
```

## Contributing

Go right ahead, submit a PR. I'm open to suggestions.

## License

The MIT License (MIT). Please see [License File](https://github.com/Brammm/CommonBundle/blob/master/Resources/meta/LICENSE) for more information.